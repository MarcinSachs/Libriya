{% extends "layout.html" %}
{% block content %}
<div class="container">
    <h2>{{ _('Edit User:') }} <span class="text-muted">{{ user.username }}</span></h2>
    <hr>

    {{ macros.display_flashes() }}
    {% endwith %}

    <form method="POST" action="">
        {{ form.hidden_tag() }}
        {{ macros.form_field(form.username, field_type='text', icon='bx-user', readonly=true) }}
        {{ macros.form_field(form.email, field_type='email', icon='bx-mail-send') }}
        {{ macros.form_field(form.role, field_type='select', icon='bx-shield-alt') }}

        <!-- Library Memberships -->
        <div class="card mb-3">
            <div class="card-header bg-light">
                <h5 class="mb-0">{{ _('Library Memberships') }}</h5>
            </div>
            <div class="card-body">
                <div class="row">
                {% for library in all_libraries %}
                    <div class="col-md-6 mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="libraries" value="{{ library.id }}" id="lib-{{ library.id }}"
                                   {% if library in user.libraries %}checked{% endif %}>
                            <label class="form-check-label" for="lib-{{ library.id }}">
                                {{ library.name }}
                            </label>
                        </div>
                    </div>
                {% else %}
                    <div class="col-12">
                        <p class="text-muted">{{ _('No libraries available to assign.') }}</p>
                    </div>
                {% endfor %}
                </div>
            </div>
        </div>
        {{ macros.form_submit(form.submit.label.text, cancel_url=url_for('users.users')) }}
            </a>
        </div>
    </form>
</div>
{% endblock %}