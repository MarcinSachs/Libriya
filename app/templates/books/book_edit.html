{% extends "base/layout.html" %}
{% block content %}
<div class="max-w-7xl mx-auto px-4">

    {{ macros.display_flashes() }}
    <h2 class="text-2xl font-bold text-gray-800">{{ _('Edit Book:') }} <span class="text-gray-600">{{ book.title }}</span></h2>
    <hr class="my-4">

    <form method="POST" action="" enctype="multipart/form-data" novalidate>

        {{ form.hidden_tag() }}

        {% if book.cover %}
        <div class="mb-3">
            <p class="block font-medium text-gray-700 mb-2">{{ _('Current Cover:') }}</p>
            <img src="{{ url_for('static', filename='uploads/' + book.cover) }}"
                alt="{{ _('Current cover for %(title)s', title=book.title) }}"
                style="max-width: 150px; height: auto; border-radius: 4px;">
        </div>
        {% endif %}

        {{ macros.form_field(form.isbn, field_type='text', icon='bx-barcode', placeholder=_("Enter ISBN")) }}
        {{ macros.form_field(form.title, field_type='text', icon='bx-file-alt', placeholder=_("e.g. The Lord of the Rings")) }}
        {{ macros.form_field(form.author, field_type='text', icon='bx-user', placeholder=_("e.g. J.R.R. Tolkien")) }}
        {{ macros.form_field(form.library, field_type='select', icon='bx-building') }}
        {{ macros.form_field(form.genres, field_type='select', icon='bx-tag', help_text=_('Hold Ctrl (or Cmd on Mac) to select multiple genres.')) }}
        {{ macros.form_field(form.year, field_type='number', icon='bx-calendar', placeholder=_("e.g. 1954")) }}
        {{ macros.form_field(form.description, field_type='textarea', icon='bx-align-left', placeholder=_('Enter a description (optional)')) }}
        <div class="mb-3">
            {{ form.cover.label(class="block font-medium text-gray-700 mb-2") }}
            <small class="text-gray-600 block mb-1">{{ _('Upload a new cover to replace the current one.') }}</small>
            {{ form.cover(class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-[#4ecdc4] focus:ring-2 focus:ring-[#4ecdc4] focus:ring-opacity-20 transition") }}
            {% for error in form.cover.errors %}<span class="text-red-500">{{ error }}</span>{% endfor %}
        </div>

        <!-- Location Section (Optional) -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 mt-4 mb-4">
            <div class="bg-gray-100 px-4 py-3 border-b border-gray-200">
                <h5 class="font-semibold text-lg mb-0">{{ _('Location Information') }} <small class="text-gray-600 font-normal">({{ _('Optional') }})</small></h5>
            </div>
            <div class="px-4 py-3">
                <div class="flex flex-wrap gap-4">
                    <div class="flex-1 min-w-xs">
                        {{ macros.form_field(form.shelf, field_type='text', icon='bx-list-ul', placeholder=_("e.g., A, B-1")) }}
                    </div>
                    <div class="flex-1 min-w-xs">
                        {{ macros.form_field(form.section, field_type='text', icon='bx-layer', placeholder=_("e.g., Fiction, Science")) }}
                    </div>
                </div>
                <div class="flex flex-wrap gap-4">
                    <div class="flex-1 min-w-xs">
                        {{ macros.form_field(form.room, field_type='text', icon='bx-door-open', placeholder=_("e.g., Main Hall, Room 2")) }}
                    </div>
                    <div class="flex-1 min-w-xs">
                        {{ macros.form_field(form.location_notes, field_type='textarea', icon='bx-note', placeholder=_("e.g., Top shelf, Near window")) }}
                    </div>
                </div>
            </div>
        </div>

        {{ macros.form_submit(form.submit.label.text, cancel_url=url_for('main.home')) }}
    </form>
</div>
{% endblock %}