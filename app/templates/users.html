{% extends "layout.html" %}
{% block content %}
<div class="container">
    {# flash messages #}
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    {% for category, message in messages %}
    <div class="alert alert-{{ category }}">{{ message }}</div>
    {% endfor %}
    {% endif %}
    {% endwith %}

    <p>
        {% set n = users|length %}
        {{ ngettext('Library currently has %(n)s user.', 'Library currently has %(n)s users.', n, n=n) }} {# Corrected:
        Added n=n for string interpolation #}
    </p>
    <h2>{{ _('Users') }}</h2> {# Translated heading #}

    <table class="table table-hover table-striped">
        <thead>
            <tr>
                <th>{{ _('Username') }}</th> {# Translated table header #}
                <th>{{ _('Email') }}</th> {# Translated table header #}
                <th>{{ _('Role') }}</th> {# Translated table header #}
                <th>{{ _('Actions') }}</th> {# Translated table header #}
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td>{{ user.username }}</td>
                <td>{{ user.email }}</td>
                <td>{% if user.is_admin %}<span class="badge bg-info">{{ _('Admin') }}</span>{% else %}<span
                        class="badge bg-secondary">{{ _('User') }}</span>{% endif %}</td> {# Translated badge text #}
                <td>
                    {# Changed to icon-only with tooltip for consistency #}
                    <a href="{{ url_for('main.user_edit', user_id=user.id) }}" class="btn btn-outline-primary btn-sm"
                        data-bs-toggle="tooltip" data-bs-placement="top" title="{{ _('Edit User') }}"><i
                            class="bx bx-edit"></i></a> {# Translated tooltip #}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <a href="{{ url_for('main.user_add') }}" class="btn btn-primary add-book-btn">{{ _('Add user') }}
    </a> {# Translated button text #}
</div>
{% endblock %}