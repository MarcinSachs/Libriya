{% extends "base/main_base.html" %}

{% block content %}
<div class="container mx-auto px-4 py-6">
    <!-- Header -->
    <div class="mb-8">
        <a href="{{ url_for('messaging.admin_support') }}" class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium text-sm transition duration-150">
            ← {{ _('Back to Support') }}
        </a>
        <h1 class="text-3xl font-bold text-gray-900 dark:text-white mt-4">{{ conversation.subject }}</h1>
        <p class="text-gray-600 dark:text-gray-400 mt-2">{{ _('Conversation with Super Admin') }}</p>
    </div>

    <!-- Messages Container -->
    <div class="max-w-3xl mx-auto">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-8 mb-8">
            <div class="space-y-6">
                {% for msg in messages %}
                <div class="{% if msg.sender_id == current_user.id %}flex justify-end{% else %}flex justify-start{% endif %}">
                    <div class="{% if msg.sender_id == current_user.id %}bg-blue-600 text-white max-w-xs{% else %}bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white max-w-xs{% endif %} rounded-lg px-4 py-3">
                        <div class="text-xs font-medium mb-1 {% if msg.sender_id == current_user.id %}text-blue-100{% else %}text-gray-600 dark:text-gray-400{% endif %}">
                            {% if msg.sender_id == current_user.id %}
                                {{ _('You') }} • {{ msg.created_at.strftime('%Y-%m-%d %H:%M') }}
                            {% else %}
                                {{ msg.sender.username }} ({{ _('Super Admin') }}) • {{ msg.created_at.strftime('%Y-%m-%d %H:%M') }}
                                {% if not msg.read %}<span class="ml-2 badge badge-green">{{ _('new') }}</span>{% endif %}
                            {% endif %}
                        </div>
                        <p class="text-sm break-words">{{ msg.message|linebreaksbr }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Reply Form -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-8">
            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">{{ _('Your Reply') }}</h3>
            <form method="POST" class="space-y-4">
                <div>
                    <textarea 
                        name="message"
                        required
                        rows="5"
                        class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition duration-200 resize-none"
                        placeholder="{{ _('Type your reply...') }}"
                    ></textarea>
                </div>
                <div class="flex gap-4 justify-end">
                    <a href="{{ url_for('messaging.admin_support') }}" class="px-6 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 font-medium transition duration-200">
                        {{ _('Back') }}
                    </a>
                    <button type="submit" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition duration-200">
                        {{ _('Send Reply') }}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
